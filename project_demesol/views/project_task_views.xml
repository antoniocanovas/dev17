<?xml version='1.0' encoding='UTF-8'?>
<odoo>

    <!-- NOTA: Observo que el filtro por defecto de v16 para no_locked no existe en v17, pero se usa en acc de ventana -->
    <!-- Que al pulsar intro busque en los nombres de las tareas Y TAMBIÉN DE SUS SUBTAREAS: -->
    <record id="project_task_available_inh_search" model="ir.ui.view">
        <field name="name">project.task.available.inh.search</field>
        <field name="model">project.task</field>
        <field name="type">search</field>
        <field name="inherit_id" ref="project.view_task_search_form_base"/>
        <field name="arch" type="xml">
            <field name="name" string="Tasks" postion="attributes">
                <attribute name="filter_domain">['|','|',('child_ids','ilike',self), ('name', 'ilike', self), ('id', 'ilike', self)]</attribute>
            </field>
            <filter name="blocked" position="before">
                <filter name="unlocked" string="Unlocked"
                        domain="[('state', 'not in', ['1_done','1_canceled']),('pnt_depend_count','=',0),('parent_id','=',False)]"/>
            </filter>
        </field>
        <field name="priority">99</field>
    </record>

    <!-- Mostrar sólo las tareas no bloqueadas en MIS TAREAS: -->
    <record id="project.action_view_my_task" model="ir.actions.act_window">
        <field name="binding_type">action</field>
        <field name="context">{'search_default_unlocked': 1, 'all_task': 0, 'default_user_ids': [(4, uid)]}</field>
    </record>

    <!-- Mostrar sólo las tareas no bloqueadas en TODAS LAS TAREASS: -->
    <record id="project.action_view_all_task" model="ir.actions.act_window">
        <field name="binding_type">action</field>
        <field name="context">{'search_default_unlocked': 1, 'default_user_ids': [(4, uid)]}</field>
    </record>

    <!-- Mostrar tareas no bloqueadas AL ABRIR UN PROYECTO: -->
    <record id="project.act_project_project_2_project_task_all" model="ir.actions.act_window">
        <field name="binding_type">action</field>
        <field name="context">{'default_project_id': active_id, 'show_project_update': True, 'search_default_unlocked': 1,}</field>
    </record>

</odoo>
